name: Resuable | Modrinth Release

on:
  workflow_call:
    inputs:
      release_type:
        type: string
        required: false
        default: "beta"
    secrets:
      MODRINTH_TOKEN:
        required: true

jobs:
  modrinth_release:
    name: Release Modrinth
    runs-on: ubuntu-latest
    steps:
      -
        name: Artifact - Download Slimefun Resourcepack
        uses: actions/download-artifact@v4
        with:
          path: workdir
          merge-multiple: true
      -
        name: Name - Fix naming
        run: |
          mv workdir/pack.zip Slimefun-ResourcePack.zip
          mv workdir/*.zip .
          ls -alh
      -
        name: DEBUG Git Version - Current Version
        id: git_version
        run: |
          echo "version=git-${GITHUB_SHA::7}" >> "$GITHUB_OUTPUT"
          echo "git-${GITHUB_SHA::7}"
      -
        name: Modrinth - Relase Beta
        uses: Kir-Antipov/mc-publish@v3.3
        with:
          modrinth-id: TznkVJky
          modrinth-featured: false
          version: ${{ steps.git_version.outputs.version }}
          version-type: beta
          loaders: minecraft
          game-versions: ">=1.19"
          dependencies: |
            otVJckYQ(recommended)
          files: |
            Slimefun-ResourcePack.zip
            item-models.zip
            ia-addons.zip
          modrinth-token: ${{ secrets.MODRINTH_TOKEN }}
